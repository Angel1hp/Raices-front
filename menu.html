<!doctype html>
<html lang="es">
<head>
  <link rel="stylesheet" href="css/notifications.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="img/logo.png" type="image/png">

  <title>Ra√≠ces</title>
  <meta name="description" content="Descubre nuestro exquisito men√∫ de alta cocina peruana con entradas, almuerzos, postres y bebidas tradicionales.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Belleza&display=swap" rel="stylesheet"> 
  
  <link rel="stylesheet" href="css/menu.css">
  <link rel="stylesheet" href="css/menu-filters.css">
  <link rel="stylesheet" href="css/menu-categories.css">
  <link rel="stylesheet" href="css/modalmenu.css">
  <link rel="stylesheet" href="css/auth-modal.css">
  <link rel="stylesheet" href="css/promociones-banner.css">
  <link rel="stylesheet" href="css/product-modal.css">
  <link rel="stylesheet" href="css/checkout.css">
</head>
<body>
  <div id="navbar-container"></div>

  <main class="main-container">
    <div class="menu-content-full">
      
      <!-- ‚úÖ CATEGOR√çAS -->
      <div class="categories-section">
        <div class="categories-header">
          <h2><span class="categories-icon"></span> Nuestra Carta</h2>
          <p class="categories-subtitle">Explora nuestros deliciosos platos</p>
        </div>
        
        <div class="categories-container-full">
          <button class="category-scroll-btn left" id="scrollLeft">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
          </button>
          
          <div class="categories-wrapper">
            <div class="categories">
              <!-- Las categor√≠as se insertan aqu√≠ din√°micamente por main.js -->
            </div>
          </div>
        </div>
      </div>

      <!-- Barra de b√∫squeda debajo de categor√≠as -->
      <div class="top-search-bar">
        <div class="search-filter">
          <span class="search-icon"></span>
          <input 
            type="text" 
            class="search-input" 
            id="searchInput" 
            placeholder="Buscar platillo..."
          >
          <button class="clear-search" id="clearSearch">‚úï</button>
        </div>
      </div>

      <!-- Grid de productos -->
      <div class="menu-products-container">
        <div id="menu-grid">
          <!-- Spinner de carga inicial -->
          <div class="loading-spinner" id="loading-spinner">
            <div class="spinner"></div>
            <p>Preparando su experiencia culinaria...</p>
          </div>
        </div>

        <!-- Paginaci√≥n -->
        <div class="pagination-container" id="paginationContainer" style="display: none;">
          <button class="pagination-btn" id="prevPage" disabled>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M12 4L6 10L12 16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Anterior
          </button>
          <div class="pagination-pages" id="paginationPages">
            <!-- Los n√∫meros de p√°gina se generar√°n aqu√≠ -->
          </div>
          <button class="pagination-btn" id="nextPage">
            Siguiente
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M8 4L14 10L8 16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- ‚úÖ PROMOCIONES EST√ÅTICAS - DEBAJO DE LOS PRODUCTOS -->
      <div class="promo-section">
        <div class="promo-header-static">
          <h2> Promociones Especiales</h2>
          <p>Aprovecha nuestras ofertas exclusivas</p>
        </div>
        
        <div class="promo-grid" id="promoGrid">
          <!-- Las promociones se cargar√°n aqu√≠ -->
        </div>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-content">
        <p class="footer-text">¬© 2025 <strong>Ra√≠ces</strong> ‚Äì Experiencia Gastron√≥mica</p>
        <div class="footer-links">
          <a href="#menu">Men√∫</a>
          <a href="registro.html">Registro</a>
          <a href="login.html">Login</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
  fetch("navbar.html")
    .then(response => response.text())
    .then(html => {
      document.getElementById("navbar-container").innerHTML = html;
      console.log("‚úÖ Navbar insertado en DOM");

      setTimeout(() => {
        if (typeof verificarSesionUsuario === "function") {
          verificarSesionUsuario();
          console.log("‚úÖ Sesi√≥n verificada");
        }

        const logoutBtn = document.getElementById('logoutBtn');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', cerrarSesion);
          console.log("‚úÖ Evento logout re-asignado");
        }

        const menuToggle = document.getElementById('menu-toggle');
        const navLinks = document.getElementById('nav-links');
        
        if (menuToggle && navLinks) {
          menuToggle.addEventListener('click', function() {
            navLinks.classList.toggle('active');
            console.log("üì± Men√∫ mobile toggled");
          });
          console.log("‚úÖ Evento men√∫ mobile asignado");
        }

        if (typeof actualizarBadgeCarrito === "function") {
          actualizarBadgeCarrito();
          console.log("‚úÖ Badge del carrito actualizado despu√©s de cargar navbar");
        }

        console.log("‚úÖ Navbar completamente configurado");
      }, 100);
    })
    .catch(error => console.error("‚ùå Error al cargar navbar:", error));
  </script>

  <!-- Modal del Carrito -->
  <div class="cart-overlay" id="cartOverlay"></div>
  <div class="cart-modal" id="cartModal">
    <div class="cart-header">
      <div>
        <h2>Mi Carrito <span class="cart-count" id="cartCountModal">0</span></h2>
      </div>
      <button class="cart-close" id="cartClose">√ó</button>
    </div>
    
    <div class="cart-content">
      <div class="cart-empty" id="cartEmpty">
        <div class="cart-empty-icon">üõí</div>
        <p>Tu carrito est√° vac√≠o</p>
      </div>
      
      <div class="cart-items" id="cartItems" style="display: none;"></div>
    </div>
    
    <div class="cart-footer" id="cartFooter" style="display: none;">
      <div class="cart-summary">
        <div class="cart-summary-row">
          <span class="cart-summary-label">Subtotal:</span>
          <span class="cart-summary-value">S/ <span id="cartSubtotal">0.00</span></span>
        </div>
      </div>
  
      <div class="cart-total">
        <span class="cart-total-label">Total:</span>
        <span class="cart-total-value">S/ <span id="cartTotal">0.00</span></span>
      </div>
      
      <button class="cart-checkout-btn" id="cartCheckout">
        Proceder al Pago
      </button>
      
      <button class="cart-clear-btn" id="cartClear">
        Vaciar Carrito
      </button>
    </div>

    <!-- CHECKOUT CONTAINER -->
    <div class="checkout-container" id="checkoutContainer">
      <div class="checkout-header">
        <button class="checkout-back-btn" onclick="volverAlCarrito()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 4L6 10L12 16"/>
          </svg>
        </button>
        <h2 class="checkout-title">Finalizar Compra</h2>
      </div>

      <div class="checkout-steps">
        <div class="checkout-step active">
          <div class="step-number">1</div>
          <div class="step-label">Entrega</div>
        </div>
        <div class="checkout-step">
          <div class="step-number">2</div>
          <div class="step-label">Pago</div>
        </div>
        <div class="checkout-step">
          <div class="step-number">3</div>
          <div class="step-label">Confirmar</div>
        </div>
      </div>

      <div class="checkout-summary">
        <h3>üì¶ Resumen del Pedido</h3>
        <div id="checkoutSummaryItems"></div>
        <div class="summary-total">
          <span class="summary-total-label">Total:</span>
          <span class="summary-total-value" id="checkoutSummaryTotal">S/ 0.00</span>
        </div>
      </div>

      <!-- PASO 1: ENTREGA -->
      <div class="checkout-step-content" style="display: block;">
        <div class="delivery-section">
          <h3>üöö Datos de Entrega</h3>
          <p style="color: #666; margin-bottom: 20px; font-size: 14px;">üìç Realizamos delivery a toda Lima Metropolitana (30-45 min aprox.)</p>
          
          <div class="form-group">
            <label>Direcci√≥n de entrega *</label>
            <input type="text" id="deliveryAddress" placeholder="Calle, n√∫mero, distrito" required>
          </div>
          
          <div class="form-group">
            <label>Referencia</label>
            <textarea id="deliveryReference" placeholder="Cerca de..., color de casa, etc." rows="2"></textarea>
          </div>
          
          <div class="form-group">
            <label>Hora de entrega *</label>
            <select id="deliveryTime" required>
              <option value="">Selecciona una hora</option>
              <option value="12:00">12:00 PM</option>
              <option value="12:30">12:30 PM</option>
              <option value="13:00">1:00 PM</option>
              <option value="13:30">1:30 PM</option>
              <option value="14:00">2:00 PM</option>
              <option value="14:30">2:30 PM</option>
              <option value="19:00">7:00 PM</option>
              <option value="19:30">7:30 PM</option>
              <option value="20:00">8:00 PM</option>
              <option value="20:30">8:30 PM</option>
              <option value="21:00">9:00 PM</option>
            </select>
          </div>
        </div>

        <div class="checkout-actions">
          <button class="checkout-btn checkout-btn-primary" onclick="continuarAPago()">
            Continuar
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M7 4L13 10L7 16"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- PASO 2: PAGO -->
      <div class="checkout-step-content" style="display: none;">
        <div class="payment-section">
          <h3>üí≥ M√©todo de Pago</h3>
          
          <div class="payment-methods">
            <div class="payment-method" onclick="seleccionarMetodoPago('tarjeta')">
              <div class="payment-method-icon">üí≥</div>
              <div class="payment-method-name">Tarjeta</div>
            </div>
            
            <div class="payment-method" onclick="seleccionarMetodoPago('yape')">
              <div class="payment-method-icon">üì±</div>
              <div class="payment-method-name">Yape</div>
            </div>
            
            <div class="payment-method" onclick="seleccionarMetodoPago('plin')">
              <div class="payment-method-icon">üí∞</div>
              <div class="payment-method-name">Plin</div>
            </div>
          </div>

          <!-- Formularios de pago -->
          <div class="payment-form" id="tarjetaForm"></div>
          <div class="payment-form" id="yapeForm"></div>
          <div class="payment-form" id="plinForm"></div>
        </div>

        <div class="checkout-actions">
          <button class="checkout-btn checkout-btn-secondary" onclick="mostrarPaso(1)">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 4L6 10L12 16"/>
            </svg>
            Volver
          </button>
          <button class="checkout-btn checkout-btn-primary" onclick="continuarAComprobante()">
            Continuar
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M7 4L13 10L7 16"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- PASO 3: COMPROBANTE -->
      <div class="checkout-step-content" style="display: none;">
        <div class="comprobante-section">
          <h3>üìÑ Tipo de Comprobante</h3>
          
          <div class="comprobante-options">
            <div class="comprobante-option active" onclick="seleccionarComprobante('boleta')">
              Boleta
            </div>
            <div class="comprobante-option" onclick="seleccionarComprobante('factura')">
              Factura
            </div>
          </div>

          <div class="ruc-input" id="rucInput">
            <div class="form-group">
              <label>RUC *</label>
              <input type="text" id="rucNumber" placeholder="Ingresa tu RUC (11 d√≠gitos)" maxlength="11">
            </div>
          </div>
        </div>

        <div class="checkout-actions">
          <button class="checkout-btn checkout-btn-secondary" onclick="mostrarPaso(2)">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 4L6 10L12 16"/>
            </svg>
            Volver
          </button>
          <button class="checkout-btn checkout-btn-primary" onclick="finalizarCompra()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 6L9 17l-5-5"/>
            </svg>
            Finalizar Compra
          </button>
        </div>
      </div>

      <!-- MENSAJE DE √âXITO -->
      <div class="checkout-success" id="checkoutSuccess">
        <div class="success-icon">‚úì</div>
        <h3 class="success-title">¬°Compra Exitosa!</h3>
        <p class="success-message">
          Tu pedido ha sido procesado correctamente.<br>
          Recibir√°s un correo de confirmaci√≥n en breve.
        </p>
        <div class="order-number">Orden #0000</div>
        <button class="checkout-btn checkout-btn-primary" onclick="cerrarCheckoutExitoso()">
          Volver al Inicio
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de Autenticaci√≥n -->
  <div class="auth-modal-overlay" id="authModalOverlay">
    <div class="auth-modal">
      <button class="auth-modal-close" id="authModalClose">√ó</button>
      <div class="auth-modal-content">
        <h2 class="auth-modal-title">Inicia sesi√≥n para continuar</h2>
        <p class="auth-modal-text">
          Para agregar productos al carrito necesitas tener una cuenta
        </p>
        <div class="auth-modal-actions">
          <a href="login.html" class="auth-modal-btn primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
              <polyline points="10 17 15 12 10 7"></polyline>
              <line x1="15" y1="12" x2="3" y2="12"></line>
            </svg>
            Iniciar sesi√≥n
          </a>
          <a href="registro.html" class="auth-modal-btn secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="8.5" cy="7" r="4"></circle>
              <line x1="20" y1="8" x2="20" y2="14"></line>
              <line x1="23" y1="11" x2="17" y2="11"></line>
            </svg>
            Crear cuenta
          </a>
        </div>
        <p class="auth-modal-footer">
          ¬øYa tienes cuenta? <a href="login.html">Inicia sesi√≥n aqu√≠</a>
        </p>
      </div>
    </div>
  </div>

  <!-- Modal de Producto -->
  <div class="product-modal-overlay" id="productModalOverlay"></div>
  <div class="product-modal" id="productModal">
    <button class="product-modal-close" id="productModalClose">√ó</button>
    
    <div class="product-modal-content">
      <div class="product-modal-image">
        <img id="productModalImage" src="" alt="">
        <div class="product-modal-discount" id="productModalDiscount" style="display: none;">
          <span id="productModalDiscountText"></span>
        </div>
      </div>
      
      <div class="product-modal-info">
        <span class="product-modal-category" id="productModalCategory"></span>
        <h2 class="product-modal-title" id="productModalTitle"></h2>
        <p class="product-modal-description" id="productModalDescription"></p>
        
        <div class="product-modal-prices">
          <span class="product-modal-price" id="productModalPrice"></span>
          <span class="product-modal-old-price" id="productModalOldPrice" style="display: none;"></span>
        </div>
        
        <div class="product-modal-quantity">
          <span class="product-modal-quantity-label">Cantidad:</span>
          <div class="product-modal-quantity-controls">
            <button class="product-modal-qty-btn" id="productModalQtyMinus">‚àí</button>
            <span class="product-modal-qty-display" id="productModalQtyDisplay">1</span>
            <button class="product-modal-qty-btn" id="productModalQtyPlus">+</button>
          </div>
        </div>
        
        <div class="product-modal-actions">
          <button class="product-modal-btn product-modal-btn-primary" id="productModalAddToCart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            Agregar al Carrito
          </button>
        </div>
        
        <div class="product-modal-extra-info">
          <div class="product-modal-info-item">
            <span class="product-modal-info-icon">üçΩÔ∏è</span>
            <span>Preparaci√≥n r√°pida</span>
          </div>
          <div class="product-modal-info-item">
            <span class="product-modal-info-icon">‚ú®</span>
            <span>Ingredientes frescos</span>
          </div>
          <div class="product-modal-info-item">
            <span class="product-modal-info-icon">üî•</span>
            <span>Receta tradicional</span>
          </div>
        </div>
      </div>
    </div>
  </div>

<script src="js/api-config.js"></script>

  <script src="js/main.js"></script>
  <script src="js/menu-filters.js"></script>
  <script src="js/category-scroll.js"></script>
  <script src="js/promociones-banner.js"></script>
  <script src="js/navbar.js"></script>
  <script src="js/checkout.js"></script>
  <script src="js/init-checkout.js"></script>
  <script src="js/config-pagos.js"></script>
  <script src="js/producto-modal.js"></script>

</body>
</html>